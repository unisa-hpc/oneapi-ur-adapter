<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>oneAPI Plugins</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,500,700,900&subset=latin,latin-ext" type="text/css">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Lato',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:linear-gradient(180deg,#888C9B28 0%,#fff 360px);min-height:100vh;color:#222}

    /* ── Header ── */
    .header{background:#fff;padding:40px 16px 36px;text-align:center}
    .header a{display:inline-block}
    .header img{height:48px;width:auto;margin-bottom:14px}
    .header h1{color:#220473;font-size:1.65rem;font-weight:300;letter-spacing:.02em}
    .header p{color:#888C9B;font-size:.92rem;margin-top:8px;max-width:620px;margin-left:auto;margin-right:auto}

    /* ── Main container ── */
    .container{max-width:920px;margin:0 auto;padding:0 16px}

    /* ── Card ── */
    .card{background:#220473 radial-gradient(ellipse at 60% 50%,#4308E5 0%,#220473 70%) no-repeat;border-radius:14px;padding:20px 22px;margin-top:-28px;position:relative;box-shadow:0 4px 24px rgba(34,4,115,.15)}

    /* ── Grid ── */
    .grid{display:grid;grid-template-columns:1fr;gap:12px}
    @media(min-width:860px){.grid{grid-template-columns:repeat(4,1fr)}}

    /* ── Vendor buttons ── */
    .vendor-section{margin-bottom:14px;padding:10px;border:1px solid rgba(255,255,255,.2);border-radius:12px;background:rgba(255,255,255,.06)}
    .vendor-label{display:block;margin:0 0 8px;font-size:.78rem;font-weight:800;letter-spacing:.08em;text-transform:uppercase;color:#fff}
    .vendor-toggle{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;width:100%}
    .vendor-btn{width:100%;appearance:none;border:1.5px solid #fff;background:transparent;color:#fff;border-radius:999px;padding:8px 16px;font-size:.82rem;font-weight:700;letter-spacing:.05em;text-transform:uppercase;cursor:pointer;transition:background .15s,color .15s,border-color .15s}
    .vendor-btn:hover{border-color:#FF4A3B;color:#FF4A3B}
    .vendor-btn.active{background:#FF4A3B;border-color:#FF4A3B;color:#fff}

    /* ── Form elements ── */
    label{font-weight:700;font-size:.82rem;text-transform:uppercase;letter-spacing:.04em;color:#cacbd2;display:block;margin:0 0 6px}
    select{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #cacbd2;font-family:inherit;font-size:.9rem;color:#222;background:#fff;transition:border-color .15s}
    select:focus{outline:none;border-color:#4308E5;box-shadow:0 0 0 3px rgba(67,8,229,.12)}

    /* ── Buttons ── */
    .actions{margin-top:16px;display:flex;flex-wrap:wrap;align-items:center;gap:10px}
    a.btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 22px;border-radius:999px;font-size:.85rem;font-weight:700;text-transform:uppercase;letter-spacing:.06em;text-decoration:none;transition:background .15s,color .15s,box-shadow .15s}
    a.btn-primary{background:#FF4A3B;color:#fff;border:none;box-shadow:0 2px 8px rgba(255,74,59,.25)}
    a.btn-primary:hover{background:#e03a2c;box-shadow:0 4px 14px rgba(255,74,59,.35)}
    a.btn-secondary{background:#fff;color:#4308E5;border:1.5px solid #4308E5}
    a.btn-secondary:hover{background:#4308E5;color:#fff}

    /* ── Code block ── */
    pre{margin-top:14px;padding:14px 16px;border-radius:10px;background:rgba(0,0,0,.2);border:1px solid rgba(255,255,255,.1);overflow-x:auto;font-size:.85rem;line-height:1.55;color:#fff}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}

    /* ── Utilities ── */
    .warn{color:#FF4A3B;font-weight:700;font-size:.88rem}
    .muted{color:#cacbd2;font-size:.88rem}
    .tip{margin-top:12px;color:#cacbd2}
    .tip code{background:rgba(255,255,255,.12);padding:2px 6px;border-radius:4px;font-size:.82rem;color:#fff}

    /* ── Footer ── */
    .footer{text-align:center;padding:32px 16px 24px;color:#888C9B;font-size:.8rem;max-width:590px;margin:0 auto}
    .footer a{color:#4308E5;text-decoration:none}
    .footer a:hover{text-decoration:underline}
  </style>
</head>
<body>

  <div class="header">
    <a href="https://uxlfoundation.org" target="_blank" rel="noreferrer">
      <img src="https://uxlfoundation.org/images/uxl-color.svg" alt="UXL Foundation">
    </a>
    <h1>Download oneAPI Plugins</h1>
    <p>Choose a configuration and download the matching installer.</p>
  </div>

  <div class="container">
    <div class="card">
      <div class="vendor-section" aria-label="Select vendor">
        <span class="vendor-label">Vendor</span>
        <div class="vendor-toggle">
          <button type="button" class="vendor-btn" data-vendor="nvidia">NVIDIA</button>
          <button type="button" class="vendor-btn" data-vendor="amd">AMD</button>
        </div>
      </div>

      <div class="grid">
        <div><label for="oneapi">oneAPI</label><select id="oneapi"></select></div>
        <div><label for="backend">Backend</label><select id="backend"></select></div>
        <div><label for="os">OS</label><select id="os"></select></div>
        <div><label for="arch">Arch</label><select id="arch"></select></div>
      </div>

      <div class="actions">
        <a id="downloadBtn" class="btn btn-primary" href="#">Download</a>
        <a id="releaseBtn" class="btn btn-secondary" href="#" target="_blank" rel="noreferrer">View release</a>
        <span id="status" class="warn"></span>
      </div>

      <pre><code id="cmd"></code></pre>
    </div>
  </div>

  <div class="footer">
    <p>Community project supported by the <a href="https://uxlfoundation.org" target="_blank" rel="noreferrer">UXL Foundation</a> maintained by the <a href="https://unisa.it" target="_blank" rel="noreferrer">University of Salerno</a>.</p>
    <p>SYCL is a trademark of the Khronos&reg; Group. Nvidia and CUDA are registered trademark of NVIDIA Corporation. AMD is a registered trademark of Advanced Micro Devices, Inc. Intel is a trademark of Intel Corporation in the U.S. and/or other countries.</p>
    <br>
    <p>Copyright &copy; 2025 Unified Acceleration Foundation. All rights reserved.</p>
    <p>Unified Acceleration Foundation is a <a href="https://jointdevelopment.org/">Joint Development Foundation Project</a></p>
    <p><a href="https://jointdevelopment.org/policies/terms/">Privacy Policy and Terms of Use</a></p>
  </div>

<script>
const $ = (id) => document.getElementById(id);
const uniq = (arr) => [...new Set(arr)].sort();
let selectedVendor = "";

function releaseUrl(owner, repo, tag){
  return `https://github.com/${owner}/${repo}/releases/tag/${tag}`;
}
function assetUrl(owner, repo, tag, filename){
  return `https://github.com/${owner}/${repo}/releases/download/${tag}/${encodeURIComponent(filename)}`;
}
function setOptions(sel, values){
  sel.innerHTML = "";
  values.forEach(v => {
    const o=document.createElement("option");
    o.value=v; o.textContent=v;
    sel.appendChild(o);
  });
}

function setOptionsPreserve(sel, values){
  const prev = sel.value;
  setOptions(sel, values);
  if (values.includes(prev)){
    sel.value = prev;
  }
}

function getSelection(){
  return {
    oneapi: $("oneapi").value,
    vendor: selectedVendor,
    backend: $("backend").value,
    os: $("os").value,
    arch: $("arch").value
  };
}

function matches(item, s){
  return item.oneapi_version === s.oneapi &&
         item.vendor === s.vendor &&
         item.backend === s.backend &&
         item.os === s.os &&
         item.arch === s.arch;
}

function update(manifest){
  const s = getSelection();
  const items = manifest.items.filter(it => matches(it, s));
  const status = $("status");

  if (items.length !== 1){
    status.textContent = items.length === 0
      ? "No artifact for this selection."
      : "Selection is ambiguous (manifest has duplicates).";
    $("downloadBtn").href = "#";
    $("releaseBtn").href = "#";
    $("cmd").textContent = "# No unique match";
    return;
  }

  status.textContent = "";
  const it = items[0];
  const url = assetUrl(manifest.owner, manifest.repo, it.tag, it.filename);
  $("downloadBtn").href = url;
  $("releaseBtn").href = releaseUrl(manifest.owner, manifest.repo, it.tag);

  const shaLine = it.sha256 && it.sha256 !== "PUT_SHA256_HERE"
    ? `echo "${it.sha256}  ${it.filename}" | sha256sum -c -\n`
    : `# (optional) add sha256 in manifest.json to enable verification\n`;

  $("cmd").textContent =
`# Download
curl -L -O "${url}"

# Verify
${shaLine}
# Install
chmod +x "${it.filename}"
./"${it.filename}" --oneapi-root /opt/intel/oneapi
`;
}

function setVendor(vendor, manifest){
  selectedVendor = vendor;
  document.querySelectorAll(".vendor-btn").forEach(btn => {
    btn.classList.toggle("active", btn.dataset.vendor === vendor);
  });

  // Build vendor-specific view from all manifest items.
  const vendorItems = manifest.items.filter(it => it.vendor === vendor);
  setOptionsPreserve($("oneapi"), uniq(vendorItems.map(it => it.oneapi_version)));
  setOptionsPreserve($("backend"), uniq(vendorItems.map(it => it.backend)));
  setOptionsPreserve($("os"), uniq(vendorItems.map(it => it.os)));
  setOptionsPreserve($("arch"), uniq(vendorItems.map(it => it.arch)));

  update(manifest);
}

(async function main(){
  const manifest = await (await fetch("./manifest.json", {cache:"no-store"})).json();

  setOptions($("oneapi"), uniq(manifest.items.map(x => x.oneapi_version)));
  setOptions($("backend"), uniq(manifest.items.map(x => x.backend)));
  setOptions($("os"), uniq(manifest.items.map(x => x.os)));
  setOptions($("arch"), uniq(manifest.items.map(x => x.arch)));

  document.querySelectorAll(".vendor-btn").forEach(btn => {
    btn.addEventListener("click", () => setVendor(btn.dataset.vendor, manifest));
  });

  ["oneapi","backend","os","arch"].forEach(id => $(id).addEventListener("change", () => update(manifest)));

  const vendors = uniq(manifest.items.map(x => x.vendor));
  selectedVendor = vendors.includes("nvidia") ? "nvidia" : vendors[0];
  setVendor(selectedVendor, manifest);
})();
</script>
</body>
</html>
